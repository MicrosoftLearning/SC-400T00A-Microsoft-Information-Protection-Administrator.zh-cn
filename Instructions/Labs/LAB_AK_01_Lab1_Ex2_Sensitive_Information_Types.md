---
lab:
  title: 练习 2 - 管理敏感信息类型
  module: Module 1 - Implement Information Protection
---


# 实验室 1 - 练习 2 - 管理敏感信息类型

Contoso Ltd. 之前遇到过员工在使用票证解决方案处理支持票证时意外发送了客户个人信息的问题。 为了在将来指导用户使用，需要使用一种自定义敏感信息类型来识别电子邮件和文档中的员工 ID，这些 ID 由三个大写字符和六个数字组成。 为了降低假正率，将使用关键字“员工”和“ID”。 在本任务中，你将创建一种新的自定义敏感信息类型、用于基于 EDM 的分类的数据库以及关键字字典。

## 任务 1 - 创建自定义敏感信息类型

在本练习中，你将使用安全与合规中心 PowerShell 模块创建新的自定义敏感信息类型，以识别关键字“员工”和“ID”旁边的员工 ID 的模式。

1. 你仍然应该会使用 lon-cl1\admin 帐户登录到客户端 1 VM (LON-CL1)。

1. 在 Microsoft Edge 中，导航到 `https://compliance.microsoft.com` 并以 JoniS@WWLxZZZZZZ.onmicrosoft.com （其中 ZZZZZZ 是实验室托管提供程序提供的唯一租户 ID）登录到 Microsoft Purview 门户 。 Joni 的密码应由实验室托管提供程序提供。

1. 展开左侧窗格中的“数据分类”，然后选择“分类器”

1. 如果显示“什么是数据分类?”消息，选择“关闭” 。

1. 从顶部窗格中，选择“敏感信息类型”。  

   >**提示：** 如果 Purview 门户中没有显示“**敏感信息类型**”，则可能是因为之前实验室中将 Joni 的权限更新为合规性管理员尚未在浏览器中更新。  你可能需要注销，并以 JoniS 的身份登录。

1. 在“敏感信息类型”选项卡上，选择“+ 创建敏感信息类型”打开新建敏感信息类型的向导 。

1. 在“为敏感信息类型命名”页面上，输入以下信息：

    - 名称：Contoso 员工 ID
    - 说明：Contoso 员工 ID 模式。

1. 选择“下一步”  。

1. 在“为此敏感信息类型定义模式”页面上，选择“+ 创建模式” 。

1. 在右侧的“新建模式”窗格中，选择“+ 添加主元素”，然后选择“正则表达式”  。

1. 在新的右侧窗格“添加正则表达式”中，输入以下内容：

    - ID：Contoso ID
    - 正则表达式：```[A-Z]{3}[0-9]{6}```
    - 字符串匹配

1. 选择“完成”。

1. 在“**新建模式**”窗格中“**支持元素**”下，选择“ **+ 添加支持元素或元素组**”下拉菜单，然后选择“**关键字列表**”。

1. 在新的右侧窗格“添加关键字列表”中，输入以下内容：

    - ID：员工 ID 关键字
    - 不区分大小写：
        - *员工*
        - *ID*
    - 在“区分大小写”字段下，选择“字匹配”的径向

1. 选择“完成”  。

1. 在“新建模式”窗口中，将“字符相似度”值减少到 100 个字符。

1. 选择“创建”按钮。

1. 回到“为此敏感信息类型定义模式”页面上，选择“下一步” 。

1. 在“选择建议的可信度级别以显示合规性策略”页面上使用默认值，并选择“下一步” 。

1. 在“查看设置并完成”页面上查看设置，然后选择“创建” 。 成功创建后，选择“完成”。

1. 使浏览器窗口保持打开状态。

你已成功创建新的敏感信息类型，以 3 个大写字母、6 个数字和 100 个字符范围内的关键字“员工”或“ID”的形式标识员工 ID。

## 任务 2 - 创建基于 EDM 的分类信息类型

作为额外的搜索模式，你将使用员工数据的数据库架构创建基于完全数据匹配 (EDM) 的分类。 数据库源文件将使用员工的以下数据字段进行格式化：Name、Birthdate、StreetAddress 和 EmployeeID。

1. 你仍然应该会使用 lon-cl1\admin 帐户登录到客户端 1 VM (LON-CL1)，并且应该会以 Joni Sherman 的身份登录到 Microsoft 365。

1. 要创建所需的 Azure AD 安全组，请选择右上角的用户图像，然后选择“注销”，以注销 Joni Sherman 帐户。

1. 关闭浏览器窗口，并打开新的浏览器窗口。

1. 在“Microsoft Edge”中，导航到 `https://admin.microsoft.com`。

1. 显示“选择帐户”页面时，选择“使用其他帐户”并以“MOD 管理员”身份 admin@WWLxZZZZZZ.onmicrosoft.com（其中 ZZZZZZ 是实验室托管提供程序提供的唯一租户 ID）登录  。  管理员的密码应由实验室托管提供程序提供。

1. 在左侧窗格中，展开“**团队和组**”，然后选择“**活动团队和组**”。

1. 在“活动团队和组”页上，在顶部导航栏中，选择“**安全组**”，然后选择“ **+ 添加安全组**”。

    ![“添加组”按钮的屏幕截图。](../Media/add-security-group.png)

1. 在“设置基本信息”屏幕上，输入以下内容：
    - **名称**：EDM_DataUploaders
    - **说明**：为 EDM 上传数据的人员。

1. 选择**下一步**。

1. 在“编辑设置”页面上，将“角色分配”保留为默认设置，然后选择“下一步”  。

1. 在“查看并完成添加组”页面上，查看设置并选择“创建组” 。

1. 当显示“已创建新组”页面时，选择“关闭” 。

1. 确保已从顶部导航栏中选择了“**安全性**”选项卡，然后选择“**刷新**”。 从列表中选择新创建的 **EDM_DataUploaders** 组，以在右侧打开 **EDM_DataUploaders** 浮出控件页。

1. 依次选择“成员”选项卡和“查看全部并管理成员” 。

1. 在“管理组成员”屏幕中，选择“(+)添加成员” 。

1. 依次选择“Joni Sherman”、“添加(1)”按钮以及后退箭头按钮 。

1. 验证“成员”下是否列出“Joni Sherman” 。

1. 单击 **X** 以关闭右侧窗格。

1. 选择带有 MOD 管理员缩写“MA”的圆圈，然后选择“注销” 。

1. 关闭浏览器窗口，然后打开一个新窗口。

1. 通过 `https://compliance.microsoft.com` 导航到 Microsoft Purview 门户。

1. 显示“选择帐户”页面时，请选择“Joni Sherman”并登录 。

1. 展开“数据分类”，选择“分类器”，然后从顶部窗格中选择“EDM 分类器”选项卡  。

   >**注意：** 创建并提供基于完全数据匹配 (EDM) 的敏感信息类型 (SIT) 是一个多阶段过程。 可以将新体验与现有经典体验结合使用。 本实验室逐步介绍如何使用经典体验创建基于 EDM 的 SIT。 如需详细了解如何使用新体验创建基于 EDM 的 SIT，请参阅以下内容：[创建完全数据匹配敏感信息类型工作流新体验](https://learn.microsoft.com/en-us/microsoft-365/compliance/sit-create-edm-sit-unified-ux-workflow?view=o365-worldwide)

1. 确保将“新 EDM 体验”的开关选择为“关闭”，以使用经典体验 。

      ![继续使用经典 EDM 体验的选项的屏幕截图。](../Media/ClassicEDMExperience.png)

1. 选择“+ 创建 EDM 架构”

1. 在“**新建 EDM 架构**”页上输入以下内容：
    - **名称**：employeedb
    - **说明**：员工数据库架构

1. 启用“忽略所有架构字段的分隔符和标点符号”。

1. 单击“选择要忽略的分隔符和标点符号”下拉菜单，然后依次选择“连字符”、“句点”、“空格”、“左括号”和“右括号”    。

1. 在第一个“架构字段名称”中输入“Name”，并选中“字段可搜索”框。

1. 从下端选择“+ 添加架构数据字段”。

1. 在“架构字段名称”中的“架构字段 2”下，输入 Birthdate 。

1. 再次从下端选择“+ 添加架构数据字段”。

1. 在“架构字段名称”中的“架构字段 3”下，输入 StreetAddress 。

1. 最后一次从下端选择“+ 添加架构数据字段”。

1. 在“架构字段名称”中的“架构字段 4”下，输入 EmployeeID 。

1. 选择“字段可搜索”。

1. 选择“保存”  。

1. 从左侧窗格中选择“EDM 敏感信息类型”。

1. 选择“+ 创建 EDM 敏感信息类型”以打开“EDM 规则包”向导 。  

1. 在“定义数据存储架构”页面上，选择“选择现有 EDM 架构” 。

1. 依次选择“employeedb”和“添加” 。

1. 查看数据存储架构，然后选择“下一步”。

1. 在“为此 EDM 敏感信息类型定义模式”页面上，选择“+ 创建模式” 。

1. 在右侧的“新建模式”窗格的“主要元素”字段中，选择“EmployeeID”。

1. 在“主元素的敏感信息类型”下，选择“+ 选择敏感信息类型” 。

1. 在“搜索栏”中，输入 Contoso 并按 Enter 键。

1. 依次选择“Contoso 员工 ID”和“完成” 。

1. 在“**新建模式**”页中选择“**完成**”。

1. 在“为此 EDM 敏感信息类型定义模式”屏幕中选择“下一步”。

1. 在“选择建议的可信度和字符相似度”中，保留默认值，然后选择“下一步” 。

1. 在“命名并描述 EDM 敏感信息类型”页面上，输入以下信息：
    - **名称**：Contoso 员工 EDM
    - **针对管理员的说明**：针对员工个人信息的基于 EDM 的敏感信息类型。

1. 选择“下一步”，查看设置，然后选择“提交” 。

1. 在“已创建你的 EDM 敏感信息类型”页面上，选择“完成” 。

1. 使 Microsoft Purview 门户在浏览器中保持打开状态。

你已成功创建基于 EDM 的新分类敏感信息类型，用于从数据库文件源中识别员工数据。

## 任务 3 - 创建基于 EDM 的分类数据源

为了将基于 EDM 的分类与包含敏感数据的数据库关联，接下来需要通过 EDM 上传代理工具对敏感信息类型的实际数据进行哈希处理并上传这些数据。

1. 你仍然应该会使用 lon-cl1\admin 帐户登录到客户端 1 VM (LON-CL1)，并且应该会以 Joni Sherman 的身份登录到 Microsoft 365。

1. 在“Microsoft Edge”中，导航到 `https://go.microsoft.com/fwlink/?linkid=2088639` 以访问 EDM 下载代理 。

1. 选择“运行”以下载并安装该工具。

1. 当安装向导在后台打开时，从任务栏中选择安装程序。

1. 在“Microsoft 精确数据匹配上传代理设置”向导中，选择“下一步” 。

1. 依次选择“我接受许可协议中的条款”和“下一步” 。

1. 请勿更改默认的“目标文件夹”路径，并选择“下一步” 。

1. 选择“安装”以执行安装。

1. 当“用户帐户控制”窗口打开时，选择“是” 。

1. 安装完成后，选择“完成”。

1. 选择左下角的 Windows 符号以打开开始菜单，输入“记事本”，然后从开始菜单中选择“记事本” 。

1. 在记事本窗口的第一行中输入以下文本：

    ``` text
    Name,Birthdate,StreetAddress,EmployeeID
    ```

1. 按 Enter 按钮，并将以下文本添加到记事本窗口中的第二行：

    ``` text
    Joni Sherman,01.06.1980,1 Main Street,CSO123456
    ```

1. 按 Enter 按钮，并将以下文本添加到记事本窗口中的第三行：

    ``` text
    Lynne Robbins,31.01.1985,2 Secondary Street,CSO654321
    ```

1. 依次选择“文件”和“另存为”，以保存文件 。

1. 从左侧窗格中选择“文档”，并在“文件名”字段中输入以下内容 ：EmployeeData.csv

1. 选择“保存类型:”下拉菜单，然后选择“所有文件( *.* )” 。

1. 选择“编码:”下拉菜单，然后依次选择“UTF-8”和“保存”  。

1. 关闭记事本窗口。

1. 在栏中使用鼠标右键选择 Windows 符号，然后选择“Windows PowerShell (管理员)”并以管理员身份运行。

1. 当“用户帐户控制”窗口打开时，选择“是” 。

1. 导航到 EDM 上传代理目录：

    ``` text
    cd "C:\Program Files\Microsoft\EdmUploadAgent"
    ```

1. 通过运行以下 cmdlet，使用你的帐户授权，将数据库上传到租户：

    ``` text
    .\EdmUploadAgent.exe /Authorize
    ```

1. 显示“选择帐户”窗口时，以 JoniS@WWLxZZZZZZ.onmicrosoft.com（其中 ZZZZZZ 是实验室托管提供程序提供的唯一租户 ID）登录。  Joni 的密码应由实验室托管提供程序提供。

1. 通过在 PowerShell 中运行以下脚本，下载基于 EDM 的分类敏感信息类型的数据库架构定义：

    ``` text
    .\EdmUploadAgent.exe /SaveSchema /DataStoreName employeedb /OutputDir "C:\Users\Admin\Documents\"
    ```

    注意：如果最后一条命令失败，则可能需要更多时间才能应用“EDM_DataUploaders”组成员身份。 可能需要一个小时才能下载架构文件。  如果失败，请继续下一个任务，稍后返回此步骤。

1. 通过在 PowerShell 中运行以下脚本，对数据库文件进行哈希处理并将其上传到基于 EDM 的分类敏感信息类型：

    ``` text
    .\EdmUploadAgent.exe /UploadData /DataStoreName employeedb /DataFile "C:\Users\Admin\Documents\EmployeeData.csv" /HashLocation "C:\Users\Admin\Documents\" /Schema "C:\Users\Admin\Documents\employeedb.xml"
    ```

1. 使用以下命令检查上传进度：

    ``` text
    .\EdmUploadAgent.exe /GetSession /DataStoreName employeedb
    ```

1. 状态显示为“已完成”后，即可使用 EDM 数据。

    ![EDM 上传代理完成的图像。](../Media/EDMUploadAgentCompleted.png)

1. 关闭 PowerShell 窗口。

你已成功对基于 EDM 的分类敏感信息类型数据库文件进行了哈希处理，并上传了该文件。

## 任务 4 - 创建关键字字典

在同事报告病假后，用户发送电子邮件时发生了几次个人信息泄露违规。  发生这种情况时，疾病原因就会被散布出去。我们不希望发生这种情况。

1. 你仍然应该会使用 lon-cl1\admin 帐户登录到客户端 1 VM (LON-CL1)，并且应该会以 Joni Sherman 的身份登录到 Microsoft 365。

1. 在 Microsoft Edge 中，Microsoft Purview 门户选项卡应该仍处于打开状态。 如果是这样，请选择该选项卡并继续进行下一步。 如果已关闭，请在新标签页中导航到 `https://compliance.microsoft.com`。

1. 展开左侧窗格中的“**数据分类**”，然后选择“**分类器**”。 从顶部窗格选择“**敏感信息类型**”。

1. 选择“+ 创建敏感信息类型”打开新建敏感信息类型向导。

1. 在“为敏感信息类型命名”页面上，输入以下信息：

    - 名称：Contoso 疾病列表
    - 描述：列出员工可能患有的疾病。

1. 选择“下一步”  。

1. 在“为此敏感信息类型定义模式”页面上，选择“+ 创建模式” 。

1. 在“**新建模式**”页上选择“**主要元素**”下面的下拉字段，然后选择“**关键字字典**”。

1. 在“**添加关键字字典**”页面上输入以下内容：

   - **名称**：疾病字典
   - **关键字**：
      - 流感
      - 流行性感冒
      - cold（冷）
      - 支气管炎
      - 耳炎  

1. 选择“完成”  。

1. 在“支持元素”下，选择“+ 添加支持元素或元素组”下拉列表并选择“关键字列表”以添加关键字字典的其他支持  。

1. 在“添加关键字列表”页面上，输入以下内容：

   - **ID**：员工缺勤
   - 不区分大小写：
     - employee
     - 缺勤
     - reason

1. 选择“完成”  。

1. 在“新建模式”页上查看配置，然后选择“创建” 。

1. 在“为此敏感信息类型定义模式”上，选择“下一步” 。

1. 在“选择建议的可信度以显示合规性策略”上保留默认值，并选择“下一步” 。

1. 在“查看设置并完成”页面上查看设置，然后选择“创建” 。  完成进程后，选择“完成”。

1. 使 Microsoft Purview 门户在浏览器窗口中保持打开状态。

你已基于关键字字典成功创建了新的敏感信息类型，并添加了更多关键字以降低误报率。 继续进行下一个任务。

## 任务 5 - 使用自定义敏感信息类型

在策略中使用自定义敏感信息类型之前，应始终对其进行测试，否则自定义搜索模式故障可能会导致数据丢失或泄漏。

1. 你仍然应该会使用 lon-cl1\admin 帐户登录到客户端 1 VM (LON-CL1)，并且应该会以 Joni Sherman 的身份登录到 Microsoft 365。

1. 选择左下角的 Windows 符号以打开开始菜单，输入“记事本”，然后从开始菜单中选择“记事本” 。

1. 在记事本窗口中输入以下文本：

    ``` text
    Employee Joni Sherman EMP123456 is absent because of the flu/influenza.
    ```

1. 依次选择“文件”和“另存为” 。

1. 在左侧窗格中选择“文档”。

1. 在“文件名”字段中，输入“SickTestData”并选择“保存”。

1. 关闭记事本窗口。

1. 在 Microsoft Edge 中，Microsoft Purview 门户选项卡应该仍处于打开状态。 如果是这样，请选择该选项卡并继续进行下一步。 如果已关闭，请在新标签页中导航到 `https://compliance.microsoft.com`。

1. 在左侧导航窗格中，展开“**数据分类**”，然后选择“**分类器**”。 选择“**敏感信息类型**”选项卡。

1. 在右上角的“搜索”框中输入“Contoso”，然后按 Enter 键。

1. 选择“Contoso 员工 ID”。

1. 选择“测试”。

1. 在“上传要测试的文件”页面上，选择“上传文件” 。

1. 从左侧窗格中选择“文档”，选择 SickTestData 文件，然后选择“打开”。

1. 选择“测试”以开始分析。

1. 在“匹配结果”页面上，查看找到的匹配项。

1. 选择“完成”以结束测试。

1. 使用顶部栏导航导航回“敏感信息类型”。

1. 搜索“Contoso”，然后选择名为“Contoso 疾病清单”的敏感信息类型。

1. 选择“测试”。

1. 在“上传要测试的文件”窗格上，选择“上传文件” 。

1. 从左侧窗格中选择“文档”，选择 SickTestData 文件，然后选择“打开”。

1. 选择“测试”以开始分析。

1. 在“匹配结果”页面上，查看找到的匹配项。 查看完后，选择“完成”。

你已成功测试了两种自定义敏感信息类型，并验证了搜索模式可以识别所需的模式。 你已完成敏感信息类型的创建，可以继续下一个练习。
